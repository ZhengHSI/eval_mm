[2024-10-29 07:17:35 root] (minicpm_v.py 584): INFO Arguments: 
[2024-10-29 07:17:35 root] (minicpm_v.py 585): INFO {'a_asym': False,
 'a_bits': 4,
 'a_groupsize': -1,
 'act_order': False,
 'add_diag': True,
 'cache_dir': './outputs/.cache',
 'cali_bsz': 4,
 'cali_dataset': 'wikitext2',
 'cali_trans': True,
 'deactive_amp': False,
 'diag_alpha': 0.3,
 'diag_init': 'sq_style',
 'direct_inv': False,
 'distribute_model': True,
 'epochs': 15,
 'exp_dir': './outputs/MiniCPM-Llama3-V-2_5/w4a4/exp',
 'exp_name': 'exp',
 'flat_lr': 0.005,
 'gptq': False,
 'gptq_mse': False,
 'hf_token': None,
 'k_asym': True,
 'k_bits': 4,
 'k_groupsize': 128,
 'lac': True,
 'lm_eval': False,
 'lm_eval_batch_size': 128,
 'lwc': True,
 'matrix_path': '/home/workspace/code/git/FlatQuant_mlm/outputs/MiniCPM-Llama3-V-2_5/w4a4/exp/',
 'model': '/home/workspace/model/MiniCPM-Llama3-V-2_5',
 'model_name': 'MiniCPM-Llama3-V-2_5',
 'nsamples': 128,
 'output_dir': './outputs',
 'percdamp': 0.01,
 'q_asym': False,
 'q_bits': 16,
 'q_groupsize': -1,
 'reload_matrix': True,
 'resume': False,
 'save_matrix': True,
 'seed': 0,
 'separate_vtrans': False,
 'tasks': ['piqa',
           'hellaswag',
           'arc_easy',
           'arc_challenge',
           'winogrande',
           'lambada_openai'],
 'v_asym': True,
 'v_bits': 4,
 'v_groupsize': 128,
 'w_asym': False,
 'w_bits': 4,
 'w_groupsize': -1,
 'warmup': False}
[2024-10-29 07:17:35 root] (minicpm_v.py 586): INFO ------------------------------------------------------------
[2024-10-29 07:17:35 root] (minicpm_v.py 584): INFO Arguments: 
[2024-10-29 07:17:35 root] (minicpm_v.py 585): INFO {'a_asym': False,
 'a_bits': 4,
 'a_groupsize': -1,
 'act_order': False,
 'add_diag': True,
 'cache_dir': './outputs/.cache',
 'cali_bsz': 4,
 'cali_dataset': 'wikitext2',
 'cali_trans': True,
 'deactive_amp': False,
 'diag_alpha': 0.3,
 'diag_init': 'sq_style',
 'direct_inv': False,
 'distribute_model': True,
 'epochs': 15,
 'exp_dir': './outputs/MiniCPM-Llama3-V-2_5/w4a4/exp',
 'exp_name': 'exp',
 'flat_lr': 0.005,
 'gptq': False,
 'gptq_mse': False,
 'hf_token': None,
 'k_asym': True,
 'k_bits': 4,
 'k_groupsize': 128,
 'lac': True,
 'lm_eval': False,
 'lm_eval_batch_size': 128,
 'lwc': True,
 'matrix_path': '/home/workspace/code/git/FlatQuant_mlm/outputs/MiniCPM-Llama3-V-2_5/w4a4/exp/',
 'model': '/home/workspace/model/MiniCPM-Llama3-V-2_5',
 'model_name': 'MiniCPM-Llama3-V-2_5',
 'nsamples': 128,
 'output_dir': './outputs',
 'percdamp': 0.01,
 'q_asym': False,
 'q_bits': 16,
 'q_groupsize': -1,
 'reload_matrix': True,
 'resume': False,
 'save_matrix': True,
 'seed': 0,
 'separate_vtrans': False,
 'tasks': ['piqa',
           'hellaswag',
           'arc_easy',
           'arc_challenge',
           'winogrande',
           'lambada_openai'],
 'v_asym': True,
 'v_bits': 4,
 'v_groupsize': 128,
 'w_asym': False,
 'w_bits': 4,
 'w_groupsize': -1,
 'warmup': False}
[2024-10-29 07:17:35 root] (minicpm_v.py 586): INFO ------------------------------------------------------------
[2024-10-29 07:17:35 transformers_modules.MiniCPM-Llama3-V-2_5.configuration_minicpm] (configuration_minicpm.py 105): INFO vision_config is None, using default vision config
[2024-10-29 07:17:35 transformers_modules.MiniCPM-Llama3-V-2_5.configuration_minicpm] (configuration_minicpm.py 105): INFO vision_config is None, using default vision config
[2024-10-29 07:17:35 root] (minicpm_v.py 584): INFO Arguments: 
[2024-10-29 07:17:35 root] (minicpm_v.py 585): INFO {'a_asym': False,
 'a_bits': 4,
 'a_groupsize': -1,
 'act_order': False,
 'add_diag': True,
 'cache_dir': './outputs/.cache',
 'cali_bsz': 4,
 'cali_dataset': 'wikitext2',
 'cali_trans': True,
 'deactive_amp': False,
 'diag_alpha': 0.3,
 'diag_init': 'sq_style',
 'direct_inv': False,
 'distribute_model': True,
 'epochs': 15,
 'exp_dir': './outputs/MiniCPM-Llama3-V-2_5/w4a4/exp',
 'exp_name': 'exp',
 'flat_lr': 0.005,
 'gptq': False,
 'gptq_mse': False,
 'hf_token': None,
 'k_asym': True,
 'k_bits': 4,
 'k_groupsize': 128,
 'lac': True,
 'lm_eval': False,
 'lm_eval_batch_size': 128,
 'lwc': True,
 'matrix_path': '/home/workspace/code/git/FlatQuant_mlm/outputs/MiniCPM-Llama3-V-2_5/w4a4/exp/',
 'model': '/home/workspace/model/MiniCPM-Llama3-V-2_5',
 'model_name': 'MiniCPM-Llama3-V-2_5',
 'nsamples': 128,
 'output_dir': './outputs',
 'percdamp': 0.01,
 'q_asym': False,
 'q_bits': 16,
 'q_groupsize': -1,
 'reload_matrix': True,
 'resume': False,
 'save_matrix': True,
 'seed': 0,
 'separate_vtrans': False,
 'tasks': ['piqa',
           'hellaswag',
           'arc_easy',
           'arc_challenge',
           'winogrande',
           'lambada_openai'],
 'v_asym': True,
 'v_bits': 4,
 'v_groupsize': 128,
 'w_asym': False,
 'w_bits': 4,
 'w_groupsize': -1,
 'warmup': False}
[2024-10-29 07:17:35 root] (minicpm_v.py 586): INFO ------------------------------------------------------------
[2024-10-29 07:17:35 transformers_modules.MiniCPM-Llama3-V-2_5.configuration_minicpm] (configuration_minicpm.py 105): INFO vision_config is None, using default vision config
[2024-10-29 07:17:35 root] (minicpm_v.py 584): INFO Arguments: 
[2024-10-29 07:17:35 root] (minicpm_v.py 585): INFO {'a_asym': False,
 'a_bits': 4,
 'a_groupsize': -1,
 'act_order': False,
 'add_diag': True,
 'cache_dir': './outputs/.cache',
 'cali_bsz': 4,
 'cali_dataset': 'wikitext2',
 'cali_trans': True,
 'deactive_amp': False,
 'diag_alpha': 0.3,
 'diag_init': 'sq_style',
 'direct_inv': False,
 'distribute_model': True,
 'epochs': 15,
 'exp_dir': './outputs/MiniCPM-Llama3-V-2_5/w4a4/exp',
 'exp_name': 'exp',
 'flat_lr': 0.005,
 'gptq': False,
 'gptq_mse': False,
 'hf_token': None,
 'k_asym': True,
 'k_bits': 4,
 'k_groupsize': 128,
 'lac': True,
 'lm_eval': False,
 'lm_eval_batch_size': 128,
 'lwc': True,
 'matrix_path': '/home/workspace/code/git/FlatQuant_mlm/outputs/MiniCPM-Llama3-V-2_5/w4a4/exp/',
 'model': '/home/workspace/model/MiniCPM-Llama3-V-2_5',
 'model_name': 'MiniCPM-Llama3-V-2_5',
 'nsamples': 128,
 'output_dir': './outputs',
 'percdamp': 0.01,
 'q_asym': False,
 'q_bits': 16,
 'q_groupsize': -1,
 'reload_matrix': True,
 'resume': False,
 'save_matrix': True,
 'seed': 0,
 'separate_vtrans': False,
 'tasks': ['piqa',
           'hellaswag',
           'arc_easy',
           'arc_challenge',
           'winogrande',
           'lambada_openai'],
 'v_asym': True,
 'v_bits': 4,
 'v_groupsize': 128,
 'w_asym': False,
 'w_bits': 4,
 'w_groupsize': -1,
 'warmup': False}
[2024-10-29 07:17:35 root] (minicpm_v.py 586): INFO ------------------------------------------------------------
[2024-10-29 07:17:35 root] (minicpm_v.py 584): INFO Arguments: 
[2024-10-29 07:17:35 root] (minicpm_v.py 585): INFO {'a_asym': False,
 'a_bits': 4,
 'a_groupsize': -1,
 'act_order': False,
 'add_diag': True,
 'cache_dir': './outputs/.cache',
 'cali_bsz': 4,
 'cali_dataset': 'wikitext2',
 'cali_trans': True,
 'deactive_amp': False,
 'diag_alpha': 0.3,
 'diag_init': 'sq_style',
 'direct_inv': False,
 'distribute_model': True,
 'epochs': 15,
 'exp_dir': './outputs/MiniCPM-Llama3-V-2_5/w4a4/exp',
 'exp_name': 'exp',
 'flat_lr': 0.005,
 'gptq': False,
 'gptq_mse': False,
 'hf_token': None,
 'k_asym': True,
 'k_bits': 4,
 'k_groupsize': 128,
 'lac': True,
 'lm_eval': False,
 'lm_eval_batch_size': 128,
 'lwc': True,
 'matrix_path': '/home/workspace/code/git/FlatQuant_mlm/outputs/MiniCPM-Llama3-V-2_5/w4a4/exp/',
 'model': '/home/workspace/model/MiniCPM-Llama3-V-2_5',
 'model_name': 'MiniCPM-Llama3-V-2_5',
 'nsamples': 128,
 'output_dir': './outputs',
 'percdamp': 0.01,
 'q_asym': False,
 'q_bits': 16,
 'q_groupsize': -1,
 'reload_matrix': True,
 'resume': False,
 'save_matrix': True,
 'seed': 0,
 'separate_vtrans': False,
 'tasks': ['piqa',
           'hellaswag',
           'arc_easy',
           'arc_challenge',
           'winogrande',
           'lambada_openai'],
 'v_asym': True,
 'v_bits': 4,
 'v_groupsize': 128,
 'w_asym': False,
 'w_bits': 4,
 'w_groupsize': -1,
 'warmup': False}
[2024-10-29 07:17:35 root] (minicpm_v.py 586): INFO ------------------------------------------------------------
[2024-10-29 07:17:35 transformers_modules.MiniCPM-Llama3-V-2_5.configuration_minicpm] (configuration_minicpm.py 105): INFO vision_config is None, using default vision config
[2024-10-29 07:17:35 root] (minicpm_v.py 584): INFO Arguments: 
[2024-10-29 07:17:35 root] (minicpm_v.py 585): INFO {'a_asym': False,
 'a_bits': 4,
 'a_groupsize': -1,
 'act_order': False,
 'add_diag': True,
 'cache_dir': './outputs/.cache',
 'cali_bsz': 4,
 'cali_dataset': 'wikitext2',
 'cali_trans': True,
 'deactive_amp': False,
 'diag_alpha': 0.3,
 'diag_init': 'sq_style',
 'direct_inv': False,
 'distribute_model': True,
 'epochs': 15,
 'exp_dir': './outputs/MiniCPM-Llama3-V-2_5/w4a4/exp',
 'exp_name': 'exp',
 'flat_lr': 0.005,
 'gptq': False,
 'gptq_mse': False,
 'hf_token': None,
 'k_asym': True,
 'k_bits': 4,
 'k_groupsize': 128,
 'lac': True,
 'lm_eval': False,
 'lm_eval_batch_size': 128,
 'lwc': True,
 'matrix_path': '/home/workspace/code/git/FlatQuant_mlm/outputs/MiniCPM-Llama3-V-2_5/w4a4/exp/',
 'model': '/home/workspace/model/MiniCPM-Llama3-V-2_5',
 'model_name': 'MiniCPM-Llama3-V-2_5',
 'nsamples': 128,
 'output_dir': './outputs',
 'percdamp': 0.01,
 'q_asym': False,
 'q_bits': 16,
 'q_groupsize': -1,
 'reload_matrix': True,
 'resume': False,
 'save_matrix': True,
 'seed': 0,
 'separate_vtrans': False,
 'tasks': ['piqa',
           'hellaswag',
           'arc_easy',
           'arc_challenge',
           'winogrande',
           'lambada_openai'],
 'v_asym': True,
 'v_bits': 4,
 'v_groupsize': 128,
 'w_asym': False,
 'w_bits': 4,
 'w_groupsize': -1,
 'warmup': False}
[2024-10-29 07:17:35 root] (minicpm_v.py 586): INFO ------------------------------------------------------------
[2024-10-29 07:17:35 root] (minicpm_v.py 584): INFO Arguments: 
[2024-10-29 07:17:35 root] (minicpm_v.py 584): INFO Arguments: 
[2024-10-29 07:17:35 root] (minicpm_v.py 585): INFO {'a_asym': False,
 'a_bits': 4,
 'a_groupsize': -1,
 'act_order': False,
 'add_diag': True,
 'cache_dir': './outputs/.cache',
 'cali_bsz': 4,
 'cali_dataset': 'wikitext2',
 'cali_trans': True,
 'deactive_amp': False,
 'diag_alpha': 0.3,
 'diag_init': 'sq_style',
 'direct_inv': False,
 'distribute_model': True,
 'epochs': 15,
 'exp_dir': './outputs/MiniCPM-Llama3-V-2_5/w4a4/exp',
 'exp_name': 'exp',
 'flat_lr': 0.005,
 'gptq': False,
 'gptq_mse': False,
 'hf_token': None,
 'k_asym': True,
 'k_bits': 4,
 'k_groupsize': 128,
 'lac': True,
 'lm_eval': False,
 'lm_eval_batch_size': 128,
 'lwc': True,
 'matrix_path': '/home/workspace/code/git/FlatQuant_mlm/outputs/MiniCPM-Llama3-V-2_5/w4a4/exp/',
 'model': '/home/workspace/model/MiniCPM-Llama3-V-2_5',
 'model_name': 'MiniCPM-Llama3-V-2_5',
 'nsamples': 128,
 'output_dir': './outputs',
 'percdamp': 0.01,
 'q_asym': False,
 'q_bits': 16,
 'q_groupsize': -1,
 'reload_matrix': True,
 'resume': False,
 'save_matrix': True,
 'seed': 0,
 'separate_vtrans': False,
 'tasks': ['piqa',
           'hellaswag',
           'arc_easy',
           'arc_challenge',
           'winogrande',
           'lambada_openai'],
 'v_asym': True,
 'v_bits': 4,
 'v_groupsize': 128,
 'w_asym': False,
 'w_bits': 4,
 'w_groupsize': -1,
 'warmup': False}
[2024-10-29 07:17:35 root] (minicpm_v.py 585): INFO {'a_asym': False,
 'a_bits': 4,
 'a_groupsize': -1,
 'act_order': False,
 'add_diag': True,
 'cache_dir': './outputs/.cache',
 'cali_bsz': 4,
 'cali_dataset': 'wikitext2',
 'cali_trans': True,
 'deactive_amp': False,
 'diag_alpha': 0.3,
 'diag_init': 'sq_style',
 'direct_inv': False,
 'distribute_model': True,
 'epochs': 15,
 'exp_dir': './outputs/MiniCPM-Llama3-V-2_5/w4a4/exp',
 'exp_name': 'exp',
 'flat_lr': 0.005,
 'gptq': False,
 'gptq_mse': False,
 'hf_token': None,
 'k_asym': True,
 'k_bits': 4,
 'k_groupsize': 128,
 'lac': True,
 'lm_eval': False,
 'lm_eval_batch_size': 128,
 'lwc': True,
 'matrix_path': '/home/workspace/code/git/FlatQuant_mlm/outputs/MiniCPM-Llama3-V-2_5/w4a4/exp/',
 'model': '/home/workspace/model/MiniCPM-Llama3-V-2_5',
 'model_name': 'MiniCPM-Llama3-V-2_5',
 'nsamples': 128,
 'output_dir': './outputs',
 'percdamp': 0.01,
 'q_asym': False,
 'q_bits': 16,
 'q_groupsize': -1,
 'reload_matrix': True,
 'resume': False,
 'save_matrix': True,
 'seed': 0,
 'separate_vtrans': False,
 'tasks': ['piqa',
           'hellaswag',
           'arc_easy',
           'arc_challenge',
           'winogrande',
           'lambada_openai'],
 'v_asym': True,
 'v_bits': 4,
 'v_groupsize': 128,
 'w_asym': False,
 'w_bits': 4,
 'w_groupsize': -1,
 'warmup': False}
[2024-10-29 07:17:35 root] (minicpm_v.py 586): INFO ------------------------------------------------------------
[2024-10-29 07:17:35 root] (minicpm_v.py 586): INFO ------------------------------------------------------------
[2024-10-29 07:17:35 transformers_modules.MiniCPM-Llama3-V-2_5.configuration_minicpm] (configuration_minicpm.py 105): INFO vision_config is None, using default vision config
[2024-10-29 07:17:35 transformers_modules.MiniCPM-Llama3-V-2_5.configuration_minicpm] (configuration_minicpm.py 105): INFO vision_config is None, using default vision config
[2024-10-29 07:17:35 transformers_modules.MiniCPM-Llama3-V-2_5.configuration_minicpm] (configuration_minicpm.py 105): INFO vision_config is None, using default vision config
[2024-10-29 07:17:35 transformers_modules.MiniCPM-Llama3-V-2_5.configuration_minicpm] (configuration_minicpm.py 105): INFO vision_config is None, using default vision config
[2024-10-29 07:17:50 root] (model_utils.py 83): INFO ---> Loading /home/workspace/model/MiniCPM-Llama3-V-2_5 Model with seq_len: 512
[2024-10-29 07:17:52 root] (model_utils.py 83): INFO ---> Loading /home/workspace/model/MiniCPM-Llama3-V-2_5 Model with seq_len: 512
[2024-10-29 07:17:52 root] (model_utils.py 83): INFO ---> Loading /home/workspace/model/MiniCPM-Llama3-V-2_5 Model with seq_len: 512
[2024-10-29 07:18:00 root] (model_utils.py 83): INFO ---> Loading /home/workspace/model/MiniCPM-Llama3-V-2_5 Model with seq_len: 512
[2024-10-29 07:18:00 root] (model_utils.py 83): INFO ---> Loading /home/workspace/model/MiniCPM-Llama3-V-2_5 Model with seq_len: 512
[2024-10-29 07:18:01 root] (model_utils.py 83): INFO ---> Loading /home/workspace/model/MiniCPM-Llama3-V-2_5 Model with seq_len: 512
[2024-10-29 07:18:01 root] (model_utils.py 83): INFO ---> Loading /home/workspace/model/MiniCPM-Llama3-V-2_5 Model with seq_len: 512
[2024-10-29 07:18:01 root] (model_utils.py 83): INFO ---> Loading /home/workspace/model/MiniCPM-Llama3-V-2_5 Model with seq_len: 512
[2024-10-29 07:18:30 root] (minicpm_v.py 594): INFO Finished applying FlatQuant to model.
[2024-10-29 07:18:30 root] (minicpm_v.py 594): INFO Finished applying FlatQuant to model.
[2024-10-29 07:18:32 root] (minicpm_v.py 594): INFO Finished applying FlatQuant to model.
[2024-10-29 07:18:39 root] (minicpm_v.py 594): INFO Finished applying FlatQuant to model.
[2024-10-29 07:18:39 root] (minicpm_v.py 594): INFO Finished applying FlatQuant to model.
[2024-10-29 07:18:39 root] (minicpm_v.py 594): INFO Finished applying FlatQuant to model.
[2024-10-29 07:18:41 root] (minicpm_v.py 594): INFO Finished applying FlatQuant to model.
[2024-10-29 07:18:41 root] (minicpm_v.py 594): INFO Finished applying FlatQuant to model.
[2024-10-29 07:20:29 root] (minicpm_v.py 597): INFO Finished reparameterize model.
[2024-10-29 07:20:29 root] (minicpm_v.py 597): INFO Finished reparameterize model.
[2024-10-29 07:20:31 root] (minicpm_v.py 597): INFO Finished reparameterize model.
[2024-10-29 07:20:36 root] (minicpm_v.py 597): INFO Finished reparameterize model.
[2024-10-29 07:20:37 root] (minicpm_v.py 597): INFO Finished reparameterize model.
[2024-10-29 07:20:39 root] (minicpm_v.py 597): INFO Finished reparameterize model.
[2024-10-29 07:20:40 root] (utils.py 48): INFO GPU memory (from rtn_fwrd): 0.11 -> 0.11 GB (0.00 GB)
[2024-10-29 07:20:41 root] (utils.py 48): INFO GPU memory (from rtn_fwrd): 0.11 -> 0.11 GB (0.00 GB)
[2024-10-29 07:20:42 root] (minicpm_v.py 597): INFO Finished reparameterize model.
[2024-10-29 07:20:43 root] (minicpm_v.py 597): INFO Finished reparameterize model.
[2024-10-29 07:20:44 root] (utils.py 48): INFO GPU memory (from rtn_fwrd): 0.11 -> 0.11 GB (0.00 GB)
[2024-10-29 07:20:50 root] (utils.py 48): INFO GPU memory (from rtn_fwrd): 0.11 -> 0.11 GB (0.00 GB)
[2024-10-29 07:20:51 root] (utils.py 48): INFO GPU memory (from rtn_fwrd): 0.11 -> 0.11 GB (0.00 GB)
[2024-10-29 07:20:51 root] (utils.py 48): INFO GPU memory (from distribute_model): 16.40 -> 16.40 GB (0.00 GB)
[2024-10-29 07:20:51 accelerate.big_modeling] (big_modeling.py 444): WARNING You shouldn't move a model when it is dispatched on multiple devices.
[2024-10-29 07:20:52 accelerate.big_modeling] (big_modeling.py 444): WARNING You shouldn't move a model when it is dispatched on multiple devices.
[2024-10-29 07:20:53 root] (utils.py 48): INFO GPU memory (from distribute_model): 16.39 -> 16.39 GB (0.00 GB)
[2024-10-29 07:20:53 accelerate.big_modeling] (big_modeling.py 444): WARNING You shouldn't move a model when it is dispatched on multiple devices.
[2024-10-29 07:20:53 accelerate.big_modeling] (big_modeling.py 444): WARNING You shouldn't move a model when it is dispatched on multiple devices.
[2024-10-29 07:20:54 root] (utils.py 48): INFO GPU memory (from rtn_fwrd): 0.11 -> 0.11 GB (0.00 GB)
[2024-10-29 07:20:55 root] (utils.py 48): INFO GPU memory (from distribute_model): 16.39 -> 16.39 GB (0.00 GB)
[2024-10-29 07:20:55 accelerate.big_modeling] (big_modeling.py 444): WARNING You shouldn't move a model when it is dispatched on multiple devices.
[2024-10-29 07:20:56 accelerate.big_modeling] (big_modeling.py 444): WARNING You shouldn't move a model when it is dispatched on multiple devices.
[2024-10-29 07:20:56 root] (utils.py 48): INFO GPU memory (from rtn_fwrd): 0.11 -> 0.11 GB (0.00 GB)
[2024-10-29 07:20:56 root] (utils.py 48): INFO GPU memory (from rtn_fwrd): 0.11 -> 0.11 GB (0.00 GB)
